# Microsoft Agent Framework (MAF) の概要

Microsoft Agent Framework (MAF) は、AIエージェントおよびマルチエージェントシステムの構築、オーケストレーション、展開を簡素化するために設計された、オープンソースのSDKおよびランタイムです。これは、現代のAIアプリケーションに向けて設計されており、2025年10月1日にパブリックプレビューとしてリリースされました。

## I. 概要と戦略的な位置づけ

MAF の最も重要な戦略的役割は、Microsoftが過去に展開してきた二大AIフレームワーク、すなわち **AutoGen** (革新的なマルチエージェントオーケストレーション)と **Semantic Kernel (SK)** (エンタープライズ対応の基盤)の長所を統一し、次世代の基盤を確立した点にあります。

- **統合の背景**: 以前、開発者は複雑なマルチエージェントにはAutoGen、エンタープライズ統合には Semantic Kernel を選択する必要がありましたが、MAF はこのd断片化を解消するために構築されました。

- **目的**: 研究レベルのイノベーションとエンタープライズグレードの安定性を統合し、開発者がローカルでプロトタイプを作成し、Azure AI Foundryでスケーラブルにデプロイできる統一されたプラットフォームを提供します。
MAF は、エンタープライズでの採用を念頭に置いた「フレームワークの柱」に基づいて設計されています。これには、最小限のボイラープレートで開始できる **「シンプル・バイ・デザイン」** や、ニーズの成長に合わせて機能を追加できる **「スケール・ウィズ・ユー」** が含まれます。

## II. 技術スタックとマルチリンガル戦略

- 対応言語とAPI

MAF は、**Python (3.10以降)** と **C#/.NET (.NET 8.0 SDK以降)** の両方を完全にサポートしており、一貫したAPIを提供します。

このマルチリンガル戦略は、データサイエンスチーム(Python)とプロダクションエンジニアリングチーム(.NET)間で分断されがちなエンタープライズ環境において、同じ抽象化の下でプロトタイプから本番デプロイへのシームレスな移行を可能にすることを目的としています。

- 相互運用性とオープン標準

MAF は、オープンスタンダードを基盤に構築されています。

- **Model Context Protocol (MCP)**: エージェントが外部ツールやデータサーバーを動的に検出して呼び出すことを可能にするプロトコルです。
- **プロバイダー非依存**: Azure OpenAI、OpenAIなど、好みのSDKを使用してエージェントを作成できます。
- **クラウド非依存**: コンテナ、オンプレミス、複数クラウドでの実行が可能な設計となっています。

## III. MA Fのコア構成要素

MAF は、個別のAIエージェント機能と、それらを連携させるワークフロー機能という二つの主要機能で構成されています。

1. **AIエージェント**: LLM (大規模言語モデル) を使用してユーザー入力を処理し、外部ツールやMCPサーバーを呼び出してアクションを実行し、応答を生成します。

- **マルチターン動作**: MAF の ChatAgent はデフォルトでマルチターン動作を行います。これは、エージェントが最終的な回答を生成できるまで、設計なしでツール呼び出しを自動的に反復し続けることを意味します。
- **ツールの簡素化**: 以前のフレームワークに比べてツールの実装が大幅に簡素化され、エージェント作成時に単一の呼び出しでツールを直接登録できます。

2. **Agent Thread (エージェントスレッド)**: MAF の ChatAgent はデフォルトでステートレスに設計されていますが、継続的な会話や長時間実行タスク中の状態管理と会話履歴の保持のためにAgent Thread が使用されます。これは、エンタープライズが求める高可用性と耐久性を達成するための重要なアーキテクチャ上の決定です。

3. ワークフロー 複数のエージェントや関数を接続して複雑な多段階タスクを実行する、グラフベースの構造を特徴としています。

- **耐久性と決定論**: グラフベースのアーキテクチャは、実行パスの決定論的な制御を確保することを目的としており、特に金融や監査といった規制の厳しい分野で求められる可視化、監査、デバッグの容易さを提供します。
- **サポート機能**: 型ベースのルーティング、ネスト(入れ子)、チェックポイント、ヒューマン・イン・ザ・ループパターンをサポートします。

4. **Context Provider (コンテキストプロバイダー)** エージェントのメモリを抽象化し、RAG(Retrieval-Augmented Generation) などのパターンを通じて、エージェントに組織固有の知識や外部データソースからの知識を提供するために使用されます。

## IV. オーケストレーションパターンと耐久性

MAF は、様々なマルチエージェントの協調パターンをサポートしています。

- **シーケンシャル**: 段階的なワークフローを実行します。
- **コンカレント (並列エージェント)**: 同時タスク実行を可能にします。
- **グループチャット型**: 複数のエージェントが協力して一つの課題に取り組みます。
- **ハンドオフ型**: サブタスク完了時にエージェント間でタスクを引き継ぎます。
- **マグネティック型**: マネージャーエージェントがタスクリスト管理と調整を行います。

これらのパターンに加え、MAF は本番環境での信頼性を高めるため、以下のエンタープライズ機能を提供します。

- **観測性 (Observability)**: OpenTelemetry に統合されており、組み込みの分散トレーシング、モニタリング、デバッグ機能を提供します。これにより、複雑なエージェント間のメッセージ交換や推論パスの追跡が可能です。
- **耐久性**: 長時間実行プロセスの回復と再開を可能にするため、ワークフローの状態をチェックポイントを介して保存できます。これにより、顧客オンボーディングや金融取引処理といった複雑なシナリオに対応します。

## V. Azure AI Foundryとの戦略的連携

MAF は、MicrosoftがAIエージェントのライフサイクル全体で一貫した標準プラットフォームを提供するための戦略的な取り組みの中核をなしています。

MAF とAzure AI Foundry Agent Serviceは、密接に連携しつつも役割が明確に分かれています。

| 側⾯ | Microsoft Agent Framework (MAF) | Azure AI Foundry Agent Service |
|------|-------------------------------|-------------------------------|
| 目的 | AIエージェントとマルチエージェントワークフローを構築・オーケストレーションするためのSDK | エージェントを管理、デプロイ、ガバナンスするためのクラウドプラットフォーム |
| 実行環境 | ローカルランタイム、自身のプロセス内(.NET/Python) | Azureクラウドプラットフォーム上のマネージドランタイム |
| セキュリティ | フレームワーク内にガバナンス機能を組み込み、監査可能な設計をサポート | **Microsoft Entra ID**統合、**RBAC**(ロールベースアクセス制御)、コンテンツ安全性の強制、ネットワーク隔離を提供 |

開発者は MAF をローカルで使って迅速にプロトタイプとデバッグを行い、その後、コードを書き直すことなく Azure AI Foundry Agent Serviceにシームレスにデプロイすることができます。

## VI. 導入事例

MAF は、研究段階の技術を企業利用に耐えうるレベルに引き上げることを目指しており、既にミッションクリティカルなプロセスに導入が進んでいます。

- **KPMG (Clara AI)**: クラウドベースのスマート監査プラットフォームに MAF を使用し、特化したエージェント
をエンタープライズデータやツールに接続しながら、組み込みのセーフガードを活用しています。

- **Commerzbank**: アバター駆動型の顧客サポートを MAF でパイロットしており、コンプライアンスに準拠した顧客対応を実現しています。

- **BMW**: MAF とFoundry Agent Service を使用して、テラバイト級の車両テレメトリーデータを分析するマルチエージェントシステムをオーケストレーションしています。

これらの事例は、MAF が単なる汎用的なアシスタントではなく、ドメイン固有の知識、規制遵守、および大規模データ処理を必要とするバックエンドプロセスを自動化するための基盤であることを示しています。

